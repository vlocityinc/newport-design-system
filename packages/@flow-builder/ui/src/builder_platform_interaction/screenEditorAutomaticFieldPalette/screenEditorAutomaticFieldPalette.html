<template>
    <div>
        <div class="slds-border_bottom">
            <div class="slds-p-horizontal_small slds-p-vertical_x-small">
                <builder_platform_interaction-sobject-or-sobject-collection-picker
                    label={labels.selectObjectLabel}
                    placeholder={labels.selectObjectPlaceholderLabel}
                    value={state.recordVariable}
                    error-message={sobjectPickerErrorMessage}
                    sobject-collection-criterion={sobjectCollectionCriterion}
                    queryable="true"
                    onsobjectreferencechanged={handleSObjectReferenceChangedEvent}
                    disable-field-drilldown
                    is-pill-supported
                    onremovemergefieldpill={handleSObjectCleared}
                ></builder_platform_interaction-sobject-or-sobject-collection-picker>
            </div>
        </div>

        <!-- empty state container when no record var is selected  with illustration -->
        <div class="slds-p-horizontal_small slds-p-vertical_x-small" if:true={showNoItemIllustrationContainer}>
            <builder_platform_interaction-illustration
                illustration="lakeMountain"
                title={labels.noItemsToShowLabel}
                body={labels.noItemsToShowDescription}
            ></builder_platform_interaction-illustration>
        </div>

        <!-- filtering input and list of fields -->
        <div class="slds-p-vertical_x-small" if:false={showNoItemIllustrationContainer}>
            <!-- error div if fields are not loaded properly -->
            <div if:true={showErrorMessageRelatedToFieldFetching} class="error">
                <span>{labels.fieldsLoadingError}</span>
            </div>
            <!-- container for search field and palette -->
            <div if:false={showErrorMessageRelatedToFieldFetching}>
                <div class="slds-p-horizontal_small">
                    <div class="slds-form-element__control slds-input-has-icon slds-input-has-icon_right">
                        <input
                            id="filter-input"
                            type="text"
                            class="slds-input palette-search-input"
                            placeholder={searchInputPlaceholder}
                            oninput={handleSearch}
                            value={state.searchPattern}
                        />
                        <lightning-icon
                            class="slds-input__icon slds-input__icon_left"
                            icon-name="utility:search"
                            size="xx-small"
                        ></lightning-icon>
                    </div>
                </div>
                <builder_platform_interaction-palette
                    data={paletteData}
                    items-draggable="true"
                    icon-size="x-small"
                    show-section-item-count="true"
                >
                </builder_platform_interaction-palette>
            </div>
        </div>
    </div>
</template>
