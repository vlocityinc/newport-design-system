<template>
    <div class="slds-form-element slds-size_1-of-3 slds-m-bottom_small">
        <lightning-combobox class="slds-col slds-grow conditionLogic"
                            label={logicComboboxLabel}
                            value={state.conditionLogicComboBoxValue}
                            options={conditionLogicOptions}
                            dropdown-alignment="auto"
                            onchange={handleConditionLogicChange}></lightning-combobox>
    </div>

    <div class="slds-form-element slds-m-bottom_small">
        <lightning-input if:true={state.showCustomLogicInput} type="text" label={labels.customLogicLabel}
                         onfocusout={handleCustomLogicFocusOut}
                         value={state.conditionLogic.value}
                         required
                         message-when-value-missing={showErrorMessageIfBlank}
                         class="slds-col customLogic"></lightning-input>
    </div>

    <builder_platform_interaction-list if:false={isConditionListVisible}
                                       items={state.conditions}
                                       onaddlistitem={handleAddCondition}
                                       onupdatelistitem={handleUpdateCondition}
                                       ondeletelistitem={handleDeleteCondition}
                                       add-label={labels.addConditionsLabel}>
        <div slot="listBody">
            <template for:each={conditionsWithPrefixes} for:item="conditionWithPrefix" for:index="conditionIndex">
                <div class="slds-list__item slds-is-relative" key={conditionWithPrefix.condition.rowIndex}>
                    <builder_platform_interaction-row item-prefix={conditionWithPrefix.prefix} show-prefix=true
                                                      item-index={conditionIndex} show-delete={showDeleteCondition}
                                                      key={conditionWithPrefix.condition.rowIndex}>
                        <div slot="rowBody">
                            <builder_platform_interaction-fer-to-ferov-expression-builder
                                    if:false={isLhsTypeField}
                                    container-element={containerElementType}
                                    expression={conditionWithPrefix.condition}
                                    lhs-label={labels.lhsLabel} operator-label={labels.operatorLabel}
                                    rhs-label={labels.rhsLabel}
                                    lhs-placeholder={labels.lhsPlaceholder}
                                    operator-placeholder={labels.operatorPlaceholder}>
                            </builder_platform_interaction-fer-to-ferov-expression-builder>
                            <builder_platform_interaction-field-to-ferov-expression-builder
                                    if:true={isLhsTypeField}
                                    fields={fields}
                                    container-element={containerElementType}
                                    expression={conditionWithPrefix.condition}
                                    lhs-label={labels.lhsLabel} operator-label={labels.operatorLabel}
                                    rhs-label={labels.rhsLabel}
                                    lhs-placeholder={labels.lhsPlaceholder}
                                    operator-placeholder={labels.operatorPlaceholder}>
                            </builder_platform_interaction-field-to-ferov-expression-builder>
                        </div>
                    </builder_platform_interaction-row>
                </div>
            </template>
        </div>
    </builder_platform_interaction-list>
</template>