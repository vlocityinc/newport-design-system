<template>
    <div if:true={field}>
        <div class='slds-p-horizontal_small slds-p-top_x-small'>
             <!--  field label and unique name -->
             <builder_platform_interaction-label-description layout-mode='vertical'
                                                             label={field.fieldText}
                                                             label-optional=true
                                                             dev-name={field.name}
                                                             hide-description
                                                             guid={field.guid}
                                                             onpropertychanged={handlePropertyChanged}> 
            </builder_platform_interaction-label-description>

            <!--  Required checkbox -->
            <builder_platform_interaction-screen-property-field
                name='isRequired' 
                label={labels.required}
                type='boolean'
                value={field.isRequired}
                onpropertychanged={handlePropertyChanged}>
            </builder_platform_interaction-screen-property-field>

            <!--  Data type: This is read-only for existing fields -->
            <builder_platform_interaction-data-type-picker
                available-data-types={dataTypeList}
                type-and-collection-disabled={isFieldDisabled}
                required
                value={dataTypePickerValue}
                onvaluechanged={handleDataTypeChanged}>
            </builder_platform_interaction-data-type-picker>
            
            <!--  default value: drop down resource list -->
            <!--  TODO - this is pulling choices, but not as strictly as we need -->
            <builder_platform_interaction-screen-property-field name='defaultValue'
                                                                label={labels.fieldDefaultValue} 
                                                                value={field.defaultValue}
                                                                type={field.dataType}
                                                                allow-resources='true' 
                                                                resource-picker-config={choiceResourcePickerConfig}
                                                                onpropertychanged={handleDefaultValuePropertyChanged}>
            </builder_platform_interaction-screen-property-field>            
        </div>
        

        <!--  Choice selectors -->
        <div>
            <lightning-accordion allow-multiple-sections-open active-section-name={allSectionNames} class='slds-has-divider slds-p-top_none'>
                <lightning-accordion-section name='choicesSection' label={labels.choices}>
                    <builder_platform_interaction-list items={field.choiceReferences}
                                                       onaddlistitem={handleChoiceAdded}
                                                       ondeletelistitem={handleChoiceDeleted}
                                                       add-label={labels.addChoice}>
                        <div slot="listBody">
                            <template for:each={fieldChoices}  for:item="choice" for:index="itemIndex" slot="listBody">
                                <div class="slds-list__item slds-is-relative" key={choice.rowIndex}>
                                    <builder_platform_interaction-row item-index={itemIndex} show-delete={showDelete}>
                                        <div slot="rowBody">
                                            <builder_platform_interaction-screen-property-field 
                                                name='choice'
                                                key={itemIndex}
                                                list-index={itemIndex}
                                                label={labels.fieldTypeLabelChoice}
                                                type={field.dataType}
                                                value={choice.displayValue}
                                                allow-resources='true' 
                                                required
                                                resource-picker-config={choiceResourcePickerConfig}
                                                onpropertychanged={handleChoiceChanged}>
                                            </builder_platform_interaction-screen-property-field>
                                        </div>
                                    </builder_platform_interaction-row>
                                </div>
                            </template>
                        </div>
                    </builder_platform_interaction-list>
                </lightning-accordion-section>

                <!--  help text -->
                <lightning-accordion-section name='helpText' label={labels.helpText}>
                    <builder_platform_interaction-screen-property-field name='helpText'
                                                                        label={labels.helpText}
                                                                        type='long_string'
                                                                        value={field.helpText}
                                                                        hide-top-padding>
                    </builder_platform_interaction-screen-property-field>
                </lightning-accordion-section>
            </lightning-accordion>
        </div>
    </div>
</template>