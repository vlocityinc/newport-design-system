<template>
    <!-- Node Button and labels -->
    <div class={iconContainerClasses}>
        <builder_platform_interaction-alc-menu-trigger
            condition-options-for-node={conditionOptionsForNode}
            element-metadata={nodeInfo.metadata}
            guid={nodeInfo.guid}
            menu-opened={nodeInfo.menuOpened}
            is-node-getting-deleted={nodeInfo.toBeDeleted}
            has-error={nodeHasError}
            canvas-mode={canvasMode}
            onclick={handleButtonClick}
            ondblclick={handleOnDblClick}
            active-element-guid={activeElementGuid}
        >
            <!-- Element Icon -->
            <div slot="trigger" class={rotateIconClass}>
                <lightning-icon
                    alternative-text={labels.nodeIconAltText}
                    class={svgClass}
                    icon-name={nodeInfo.metadata.icon}
                    size={iconSize}
                    variant="inverse"
                    aria-label={iconAriaLabel}
                    aria-haspopup="dialog"
                ></lightning-icon>
            </div>

            <!-- Selection Checkbox -->
            <lightning-button-icon
                if:true={showCheckboxInSelectionMode}
                slot="selection-checkbox"
                alternative-text={labels.selectionCheckboxAltText}
                class="selection-checkbox"
                disabled={shouldDisableCheckbox}
                icon-name={checkboxIconName}
                size="small"
                variant={checkboxVariant}
                onclick={handleSelectionCheckboxClick}
                aria-label={labels.checkboxLabel}
            ></lightning-button-icon>
        </builder_platform_interaction-alc-menu-trigger>
        <!-- Label and Element Type -->
        <div if:false={dynamicNodeConstructor} class={textContainerClasses}>
            <div class="text-element-label slds-text-body_regular">{nodeLabel}</div>
            <div if:true={showElementType} class="text-element-type slds-text-body_regular slds-truncate">
                {nodeInfo.metadata.label}
            </div>
            <div if:true={hasIncomingGoto} class="slds-text-body_regular slds-truncate text-incoming-goto">
                {incomingGoToLabel}
            </div>
        </div>

        <!--Error icon-->
        <lightning-icon
            if:true={nodeHasError}
            icon-name="utility:error"
            variant="error"
            size="xx-small"
            alternative-text={labels.errorIconAlternativeText}
            title={labels.errorIconTitle}
            class="error-icon slds-is-absolute slds-button-icon_small"
        ></lightning-icon>
    </div>

    <x-lazy
        if:true={dynamicNodeConstructor}
        lwc:dynamic={dynamicNodeConstructor}
        node={nodeInfo}
        is-default-mode={isDefaultMode}
        active-element-guid={activeElementGuid}
        class={dynamicNodeClasses}
        onpopovertoggled={handlePopoverToggled}
        disable-add-elements={disableAddElements}
        disable-delete-elements={disableDeleteElements}
        disable-edit-elements={disableEditElements}
    ></x-lazy>
</template>
