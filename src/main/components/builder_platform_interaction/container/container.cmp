<aura:component controller="serviceComponent://ui.interaction.builder.components.controllers.FlowBuilderController"
    description="This container is responsible for rendering raptor components and get data from java controller">
    <!-- Imports -->
    <builder_platform_interaction:storeLib aura:id="storeLib" />
    <builder_platform_interaction:reducers aura:id="reducers" />
    <builder_platform_interaction:actions aura:id="actions" />
    <builder_platform_interaction:translatorLib aura:id="translatorLib" />
    <builder_platform_interaction:ruleLib aura:id="ruleLib" />
    <!-- Importing jsplumb as an aura lib. This attaches jsplumb in window scope, but one should only use the instance created in drawing-lib from the canvas component -->
    <aura:import library="builder_platform_interaction:jsplumb" property="lib" />

    <!--Attributes-->
    <aura:attribute name="flowId" type="String" description="The id of the flow to load" />
    <aura:attribute name="flowDefId" type="String"
        description="The id of the flow definition associated with the flow we are loading" />
    <aura:attribute
        name="interviewGuid"
        type="String"
        description="The guid of the saved flow interview to debug in the builder"
    />
    <aura:attribute name="builderType" type="String" description="Type of the builder application" />
    <aura:attribute name="builderConfig" type="Object" description="Configuration for the current builder type" />
    <aura:attribute name="guardrailsParams" type="Map" default="{}" description="Params to execute guardrails" />
    <aura:attribute name="complianceBannerEnabled" type="Boolean" description="Is Compliance Banner org perm enabled" />
    <!-- Attributes for new flow creation -->
    <aura:attribute name="processType" type="String" description="processType for new flow" />
    <aura:attribute name="triggerType" type="String" description="triggerType for new flow" />
    <aura:attribute name="recordTriggerType" type="String" description="recordTriggerType for new record-triggered flow" />
    <aura:attribute name="startObject" type="String" description="object name for new record-triggered flow start node" />
    <aura:attribute name="hasAsyncPath" type="Boolean" description="if Run Asynchronously path exists for new flow" />

    <!--Private Attributes-->
    <aura:attribute name="storeInstance" type="Object" description="This is instance of global store." />

    <!-- Dependencies -->
    <aura:dependency resource="markup://builder_platform_interaction:propertyEditor" type="COMPONENT" />
    <aura:dependency resource="markup://builder_platform_interaction:propertyEditorHeader" type="COMPONENT" />
    <aura:dependency resource="markup://builder_platform_interaction:propertyEditorFooter" type="COMPONENT" />
    <aura:dependency resource="markup://builder_platform_interaction:debugEditor" type="COMPONENT" />
    <aura:dependency resource="markup://lightning:overlayInteropWrapper" type="COMPONENT" />
    <aura:dependency resource="markup://force:showToast" type="EVENT" />
    <aura:dependency resource="markup://force:toastManager" type="COMPONENT" />


    <!-- Editors must be included here because the dependency chain isn't being enforced by default
     All ( or most ) other modules are included by default because they're referenced by either
     lwc templates or lwc javascript files.
     The editors are dynamically created and only referenced in strings
    -->
    <aura:dependency resource="markup://builder_platform_interaction:flowPropertiesEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:connectorPicker" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:assignmentEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:decisionEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:waitEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:screenEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:loopEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:calloutEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:invocableActionEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:apexPluginEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:subflowEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:recordCreateEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:recordLookupEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:recordUpdateEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:recordDeleteEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:variableConstantEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:resourceEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:formulaEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:screenEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:modalHeader" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:modalBody" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:modalFooter" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:statusIconSummary" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:newFlowModalBody" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:recordChangeTriggerEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:contextRecordEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:scheduledPathEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:scheduleTriggerEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:platformEventEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:rollbackEditor" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:modalHeaderForAutoLayout" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:modalBodyForAutoLayout" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:modalFooterForAutoLayout" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:flowTestManager" type="MODULE" />
    <aura:dependency resource="markup://builder_platform_interaction:flowTestEditor" type="MODULE" />

    <!-- Events -->
    <aura:registerEvent name="ui:createPanel" type="markup://ui:createPanel" />
    <aura:registerEvent name="guardrailsResult" type="visualEditor:guardrailsResult" />

    <div class="flow-builder-container">
        <force:toastManager global="true" />
        <aura:if isTrue="{!v.complianceBannerEnabled}">
            <one:systemMessage aura:id="oneSystemMessage" openUrlsInNewWindow="true" />
        </aura:if>
        <builder_platform_interaction:editor
            flowId="{!v.flowId}"
            flowDefId="{!v.flowDefId}"
            interviewGuid="{!v.interviewGuid}"
            builderType="{!v.builderType}"
            builderConfig="{!v.builderConfig}"
            processType="{!v.processType}"
            triggerType="{!v.triggerType}"
            recordTriggerType="{!v.recordTriggerType}"
            startObject="{!v.startObject}"
            hasAsyncPath="{!v.hasAsyncPath}"
            guardrailsParams="{!v.guardrailsParams}"
            onguardrailresult="{!c.handleGuardrailResult}"/>
    </div>
</aura:component>
